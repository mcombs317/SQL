/* As an assignment, I answered the following questions from a database with multiple tables. */

1.  How many orders were placed in January?
2.  How many of those orders were for an iPhone?
3.  Select the customer account numbers for all the orders that were placed in February.
4.  Which product was the cheapest one sold in January, and what was the price?
5.  What is the total revenue for each product sold in January? (Revenue can be calculated using the number of products sold and the price of the products).
6.  Which products were sold in February at 548 Lincoln St, Seattle, WA 98101, how many of each were sold, and what was the total revenue?
7.  How many customers ordered more than 2 products at a time in February, and what was the average amount spent for those customers?


/* I always review the tables I need before answering questions. */
SELECT * FROM JanSales;
SELECT * FROM FebSales;
SELECT * FROM customers;

/* Answer to #1 */
SELECT COUNT(orderid) 
FROM JanSales;

/* Answer to #2 */
SELECT COUNT(orderid), product 
FROM JanSales
WHERE product = "iPhone";

/* Answer to #3 */
SELECT acctnum 
FROM customers
JOIN FebSales
ON customers.order_id = FebSales.orderID;

/* Answer to #4 */
SELECT DISTINCT product, MIN(price) 
FROM JanSales 
GROUP BY product, price
ORDER BY price asc;

/* Answer to #5 */
SELECT SUM(quantity)* price AS revenue 
FROM JanSales
GROUP BY product;

/* Answer to #6 */
SELECT SUM(quantity), product, SUM(quantity) * price AS revenue, location
FROM FebSales
WHERE location = "548 Lincoln St, Seattle, WA 98101"
GROUP BY product;

/* Answer to #7 */
SELECT COUNT(DISTINCT customers.acctnum), AVG(FebSales.price * FebSales.quantity) 
FROM FebSales
JOIN customers
ON customers.order_id = FebSales.orderID
WHERE quantity > 2;
